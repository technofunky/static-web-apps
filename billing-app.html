<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Restaurant Billing App</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 20px;
    }
    .container {
      max-width: 800px;
      margin: auto;
    }
    .form-group {
      margin-bottom: 15px;
    }
    .form-group label {
      display: block;
      font-weight: bold;
    }
    .form-group input, .form-group select, .form-group button, .form-group textarea {
      width: 100%;
      padding: 10px;
      margin-top: 5px;
    }
    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 20px;
    }
    table, th, td {
      border: 1px solid #ccc;
    }
    th, td {
      padding: 8px;
      text-align: left;
    }
    #billTable {
      margin-top: 20px;
    }
    #pastBillsTable {
      margin-top: 20px;
    }
    .actions {
      margin-top: 20px;
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>Restaurant Billing App</h1>

    <div class="form-group">
      <label for="customerName">Customer Name:</label>
      <input type="text" id="customerName" placeholder="Enter customer name">
    </div>

    <div class="form-group">
      <label for="menuItems">Select Menu Item:</label>
      <select id="menuItems"></select>
      <button onclick="addItem()">Add Item</button>
    </div>

    <div id="billTable">
      <h2>Current Bill</h2>
      <table>
        <thead>
          <tr>
            <th>Item</th>
            <th>Price</th>
            <th>Actions</th>
          </tr>
        </thead>
        <tbody id="billItems"></tbody>
        <tfoot>
          <tr>
            <td colspan="2"><strong>Subtotal</strong></td>
            <td id="subtotal">0.00</td>
          </tr>
          <tr>
            <td colspan="2"><strong>Tax (10%)</strong></td>
            <td id="tax">0.00</td>
          </tr>
          <tr>
            <td colspan="2"><strong>Total</strong></td>
            <td id="total">0.00</td>
          </tr>
        </tfoot>
      </table>
    </div>

    <div class="actions">
      <button onclick="saveBill()">Save Bill</button>
      <button onclick="printBill()">Print Bill</button>
    </div>

    <div id="pastBills">
      <h2>Past Bills</h2>
      <button onclick="exportBillsToCSV()">Export All Bills to CSV</button>
      <table id="pastBillsTable">
        <thead>
          <tr>
            <th>Customer Name</th>
            <th>Items</th>
            <th>Total</th>
          </tr>
        </thead>
        <tbody></tbody>
      </table>
    </div>
  </div>

  <script>
    let menu = [
      { name: 'Burger', price: 5.99 },
      { name: 'Pizza', price: 8.99 },
      { name: 'Pasta', price: 6.99 },
      { name: 'Salad', price: 4.99 },
    ];

    let currentBill = [];
    let pastBills = JSON.parse(localStorage.getItem('pastBills')) || [];

    function loadMenu() {
      const menuDropdown = document.getElementById('menuItems');
      menu.forEach(item => {
        const option = document.createElement('option');
        option.value = item.name;
        option.textContent = `${item.name} - $${item.price.toFixed(2)}`;
        menuDropdown.appendChild(option);
      });
    }

    function addItem() {
      const selectedItem = document.getElementById('menuItems').value;
      const item = menu.find(m => m.name === selectedItem);
      if (item) {
        currentBill.push(item);
        renderBill();
      }
    }

    function removeItem(index) {
      currentBill.splice(index, 1);
      renderBill();
    }

    function renderBill() {
      const billItems = document.getElementById('billItems');
      const subtotalElem = document.getElementById('subtotal');
      const taxElem = document.getElementById('tax');
      const totalElem = document.getElementById('total');

      billItems.innerHTML = '';
      let subtotal = 0;

      currentBill.forEach((item, index) => {
        subtotal += item.price;
        const row = document.createElement('tr');
        row.innerHTML = `
          <td>${item.name}</td>
          <td>$${item.price.toFixed(2)}</td>
          <td><button onclick="removeItem(${index})">Remove</button></td>
        `;
        billItems.appendChild(row);
      });

      const tax = subtotal * 0.1;
      const total = subtotal + tax;

      subtotalElem.textContent = subtotal.toFixed(2);
      taxElem.textContent = tax.toFixed(2);
      totalElem.textContent = total.toFixed(2);
    }

    function saveBill() {
      const customerName = document.getElementById('customerName').value.trim();
      if (!customerName) {
        alert('Customer name is required.');
        return;
      }
      if (currentBill.length === 0) {
        alert('Add at least one item to the bill.');
        return;
      }

      const total = parseFloat(document.getElementById('total').textContent);
      const newBill = {
        customerName,
        items: currentBill,
        total,
      };

      pastBills.push(newBill);
      localStorage.setItem('pastBills', JSON.stringify(pastBills));
      renderPastBills();
      currentBill = [];
      document.getElementById('customerName').value = '';
      renderBill();
      alert('Bill saved successfully!');
    }

    function renderPastBills() {
      const pastBillsTable = document.getElementById('pastBillsTable').querySelector('tbody');
      pastBillsTable.innerHTML = '';
      pastBills.forEach(bill => {
        const row = document.createElement('tr');
        const itemsList = bill.items.map(item => `${item.name} ($${item.price.toFixed(2)})`).join(', ');
        row.innerHTML = `
          <td>${bill.customerName}</td>
          <td>${itemsList}</td>
          <td>$${bill.total.toFixed(2)}</td>
        `;
        pastBillsTable.appendChild(row);
      });
    }

    function exportBillsToCSV() {
      let csv = 'Customer Name,Items,Total\n';
      pastBills.forEach(bill => {
        const itemsList = bill.items.map(item => `${item.name} ($${item.price.toFixed(2)})`).join('; ');
        csv += `"${bill.customerName}","${itemsList}",${bill.total.toFixed(2)}\n`;
      });

      const blob = new Blob([csv], { type: 'text/csv' });
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.href = url;
      a.download = 'past_bills.csv';
      a.click();
    }

    function printBill() {
      window.print();
    }

    window.onload = () => {
      loadMenu();
      renderPastBills();
    };
  </script>
</body>
</html>
